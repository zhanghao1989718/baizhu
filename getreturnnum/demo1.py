# coding:utf-8
import pymysql

result = ['2020-02-09', '213001__213001', '模拟大师', '3', '1.20', '3.60', '2020-02-08', '213001__213001', '模拟大师', '3', '1.20', '3.60', '2020-02-08', '212701__212701', '模拟大师', '13911', '1.20', '16693.20', '2020-02-08', '212201__212201', '模拟大师', '3129', '1.20', '3754.80', '2020-02-08', '212101__212101', '模拟大师', '10', '1.20', '12.00', '2020-02-08', '211701__211701', '模拟大师', '43', '1.20', '51.60', '2020-02-08', '211601__211601', '模拟大师', '563', '1.20', '675.60', '2020-02-08', '211401__211401', '模拟大师', '7', '1.20', '8.40', '2020-02-08', '211301__211301', '模拟大师', '179', '1.20', '214.80', '2020-02-08', '211201__211201', '模拟大师', '2', '1.20', '2.40', '2020-02-08', '210701__210701', '模拟大师', '2', '1.20', '2.40', '2020-02-08', '210201__210201', '模拟大师', '15', '1.20', '18.00', '2020-02-07', '213001__213001', '模拟大师', '3', '1.20', '3.60', '2020-02-07', '212701__212701', '模拟大师', '15209', '1.20', '18250.80', '2020-02-07', '212201__212201', '模拟大师', '3739', '1.20', '4486.80', '2020-02-07', '212101__212101', '模拟大师', '11', '1.20', '13.20', '2020-02-07', '211701__211701', '模拟大师', '53', '1.20', '63.60', '2020-02-07', '211601__211601', '模拟大师', '1076', '1.20', '1291.20', '2020-02-07', '211401__211401', '模拟大师', '7', '1.20', '8.40', '2020-02-07', '211301__211301', '模拟大师', '176', '1.20', '211.20', '2020-02-07', '211201__211201', '模拟大师', '2', '1.20', '2.40', '2020-02-07', '210701__210701', '模拟大师', '4', '1.20', '4.80', '2020-02-07', '210401__210401', '模拟大师', '1', '1.20', '1.20', '2020-02-07', '210201__210201', '模拟大师', '24', '1.20', '28.80', '2020-02-06', '213001__213001', '模拟大师', '5', '1.20', '6.00', '2020-02-06', '212701__212701', '模拟大师', '17093', '1.20', '20511.60', '2020-02-06', '212201__212201', '模拟大师', '4014', '1.20', '4816.80', '2020-02-06', '212101__212101', '模拟大师', '10', '1.20', '12.00', '2020-02-06', '211701__211701', '模拟大师', '69', '1.20', '82.80', '2020-02-06', '211601__211601', '模拟大师', '810', '1.20', '972.00', '2020-02-06', '211401__211401', '模拟大师', '11', '1.20', '13.20', '2020-02-06', '211301__211301', '模拟大师', '168', '1.20', '201.60', '2020-02-06', '211201__211201', '模拟大师', '5', '1.20', '6.00', '2020-02-06', '210701__210701', '模拟大师', '9', '1.20', '10.80', '2020-02-06', '210401__210401', '模拟大师', '1', '1.20', '1.20', '2020-02-06', '210201__210201', '模拟大师', '29', '1.20', '34.80', '2020-02-05', '213001__213001', '模拟大师', '2', '1.20', '2.40', '2020-02-05', '212701__212701', '模拟大师', '20112', '1.20', '24134.40', '2020-02-05', '212201__212201', '模拟大师', '4675', '1.20', '5610.00', '2020-02-05', '212101__212101', '模拟大师', '11', '1.20', '13.20', '2020-02-05', '211701__211701', '模拟大师', '88', '1.20', '105.60', '2020-02-05', '211601__211601', '模拟大师', '1150', '1.20', '1380.00', '2020-02-05', '211401__211401', '模拟大师', '15', '1.20', '18.00', '2020-02-05', '211301__211301', '模拟大师', '174', '1.20', '208.80', '2020-02-05', '211201__211201', '模拟大师', '2', '1.20', '2.40', '2020-02-05', '210701__210701', '模拟大师', '4', '1.20', '4.80', '2020-02-05', '210401__210401', '模拟大师', '0', '1.20', '0.00', '2020-02-05', '210201__210201', '模拟大师', '22', '1.20', '26.40', '2020-02-04', '213001__213001', '模拟大师', '4', '1.20', '4.80', '2020-02-04', '212701__212701', '模拟大师', '21260', '1.20', '25512.00', '2020-02-04', '212201__212201', '模拟大师', '5979', '1.20', '7174.80', '2020-02-04', '212101__212101', '模拟大师', '13', '1.20', '15.60', '2020-02-04', '211701__211701', '模拟大师', '187', '1.20', '224.40', '2020-02-04', '211601__211601', '模拟大师', '2289', '1.20', '2746.80', '2020-02-04', '211401__211401', '模拟大师', '12', '1.20', '14.40', '2020-02-04', '211301__211301', '模拟大师', '8', '1.20', '9.60', '2020-02-04', '211201__211201', '模拟大师', '6', '1.20', '7.20', '2020-02-04', '210701__210701', '模拟大师', '5', '1.20', '6.00', '2020-02-04', '210401__210401', '模拟大师', '1', '1.20', '1.20', '2020-02-04', '210201__210201', '模拟大师', '28', '1.20', '33.60', '2020-02-03', '213001__213001', '模拟大师', '8', '1.20', '9.60', '2020-02-03', '212701__212701', '模拟大师', '23057', '1.20', '27668.40', '2020-02-03', '212201__212201', '模拟大师', '4748', '1.20', '5697.60', '2020-02-03', '212101__212101', '模拟大师', '18', '1.20', '21.60', '2020-02-03', '211701__211701', '模拟大师', '146', '1.20', '175.20', '2020-02-03', '211601__211601', '模拟大师', '3288', '1.20', '3945.60', '2020-02-03', '211401__211401', '模拟大师', '15', '1.20', '18.00', '2020-02-03', '211301__211301', '模拟大师', '194', '1.20', '232.80', '2020-02-03', '211201__211201', '模拟大师', '9', '1.20', '10.80', '2020-02-03', '210701__210701', '模拟大师', '8', '1.20', '9.60', '2020-02-03', '210401__210401', '模拟大师', '1', '1.20', '1.20', '2020-02-03', '210201__210201', '模拟大师', '43', '1.20', '51.60', '2020-02-02', '213001__213001', '模拟大师', '4', '1.20', '4.80', '2020-02-02', '212701__212701', '模拟大师', '19961', '1.20', '23953.20', '2020-02-02', '212201__212201', '模拟大师', '4288', '1.20', '5145.60', '2020-02-02', '212101__212101', '模拟大师', '10', '1.20', '12.00', '2020-02-02', '211701__211701', '模拟大师', '60', '1.20', '72.00', '2020-02-02', '211601__211601', '模拟大师', '2436', '1.20', '2923.20', '2020-02-02', '211401__211401', '模拟大师', '9', '1.20', '10.80', '2020-02-02', '211301__211301', '模拟大师', '163', '1.20', '195.60', '2020-02-02', '211201__211201', '模拟大师', '2', '1.20', '2.40', '2020-02-02', '210701__210701', '模拟大师', '3', '1.20', '3.60', '2020-02-02', '210401__210401', '模拟大师', '1', '1.20', '1.20', '2020-02-02', '210201__210201', '模拟大师', '18', '1.20', '21.60', '2020-02-01', '213001__213001', '模拟大师', '3', '1.20', '3.60', '2020-02-01', '212701__212701', '模拟大师', '19284', '1.20', '23140.80', '2020-02-01', '212201__212201', '模拟大师', '3957', '1.20', '4748.40', '2020-02-01', '212101__212101', '模拟大师', '12', '1.20', '14.40', '2020-02-01', '211701__211701', '模拟大师', '27', '1.20', '32.40', '2020-02-01', '211601__211601', '模拟大师', '2152', '1.20', '2582.40', '2020-02-01', '211401__211401', '模拟大师', '9', '1.20', '10.80', '2020-02-01', '211301__211301', '模拟大师', '162', '1.20', '194.40', '2020-02-01', '211201__211201', '模拟大师', '2', '1.20', '2.40', '2020-02-01', '210701__210701', '模拟大师', '2', '1.20', '2.40', '2020-02-01', '210201__210201', '模拟大师', '16', '1.20', '19.20']
result_num = len(result)
list_all = []
for x in range(result_num//6):
    list_single = []
    for i in [0+6*x, 1+6*x, 2+6*x, 3+6*x, 5+6*x]:
        list_single.append(result[i])
        i += 1
    tuple_single = tuple(list_single)
    list_all.append(tuple_single)
print(list_all)
print(len(list_all))
db = pymysql.Connect(
  host='baizhudata.mysql.rds.aliyuncs.com',port=3900,
  user='intelsys',passwd='Baizhu7958',database='intelsys')
#创建一个游标
cursor = db.cursor()
# 创建表
# sql = '''
# CREATE TABLE `test_get_data` (
#   `id` int(15) NOT NULL AUTO_INCREMENT,
#   `date` date NOT NULL,
#   `sid` char(20) NOT NULL,
#   `soft_name` char(20) NOT NULL,
#   `num` int(11) NOT NULL,
#   `return_point` double(14,3) NOT NULL,
#   `price` double(14,3) NOT NULL,
#   PRIMARY KEY (`id`),
#   UNIQUE KEY `id` (`id`),
#   UNIQUE INDEX (`date`,`sid`)
# ) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8
# '''

# 编写插入数据的sql
sql = "replace into test_get_data (date,sid,soft_name,num,price) values (%s, %s, %s, %s, %s)"
try:
    # 执行sql
    cursor.executemany(sql, list_all)
    db.commit()
    print("插入数据成功")
except Exception as e:
    print(e)
    # 数据回滚
    db.rollback()
    print("插入数据失败")
finally:
    # 关闭游标连接
    cursor.close()
    # 关闭数据库连接
    db.close()


